---
title: "VECMPAPER"
output:
  pdf_document: default
  html_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tseries)
library(ggpubr)
library(forecast)
library(lubridate)
library(lmtest)
library(vars)
library(tsDyn)
set.seed(2022)
data <- read.csv("cryptosup.csv")

```



# Introduction

In this paper I will analyze Crypto currencies, and for that I choose 6 different coins which are Bitcoin, Ethereum, Cardano, and Waves, this choice of coins was mostly due to the data available as the Crypto market is new and so are some of the coins, also, I made sure to have balance between a few more established coins such as Bitcoin and Ethereum while the others are still new and have not yet fully been established.I got the data from Yahoo Finance, and it includes a range from 221 to 385 weekly observations depending on the coin, for my project I intend to use closing price of the week, however, the data also included opening, high and low price of the week and volume of trades for the week. Daily data was also available, however, cryptocurrencies are extremely volatile which caused daily data to be quite noisy, which is why I choose weekly data despite lowering the number of observations.


# Vector Error Correction Model

Bitcoin is the oldest and most dominant cryptocurrency its price is almost 3 times the price of its closest competitor Ethereum, for many it is considered as "digital gold" and a lot of the cheaper currencies can only be purchased with Bitcoin, therefore, its very likely that the movements in Bitcoin price are likely to be very impactful throughout the cryptocurrency market as a lot of the thrust in the cryptocurrency market has been due to Bitcoin's success, however, it is quite unlikely that movements on Cardano which costs a fraction of the Price of Bitcoin have any impact whatsoever on its price. Therefore, for my VECM model I have decided to use 3 equations 







```{r,echo=FALSE}


#data$Date <-mdy(data$Date)

datadif <-data  %>% mutate(difbtc = log(data$Bitcoin) - log(lag(data$Bitcoin)))

datadif <-datadif %>% mutate(difada = log(data$Cardano) - log(lag(data$Cardano)))

datadif <-datadif  %>% mutate(difwave = log(data$Waves) - log(lag(data$Waves)))

datadif <-datadif  %>% mutate(difeth = log(data$Ethereum) - log(lag(data$Ethereum)))

datadif$Date <- as.Date(data$Date)
data1 <- datadif[2:215,6:9]
var1 <- VAR(data1,p=15,type = 'const')
data2 <- datadif[2:215,2:5]
vecm<-VECM(data.frame(waves=log(data2[,4]),cardano=log(data2[,2]),eth=log(data2[,3]),btc=log(data2[,1])), lag=25, estim="ML",r=3)

rmses <- data.frame("ARMA_RMSE"=NA,"VAR_RMSE"=NA,"VECM_RMSE"=NA)
colors<- c("Forecast"="red","Data"="black")
```



#Bitcoin


```{r,echo=FALSE,fig.width=10,fig.height=7}
fit <- Arima(data1$difbtc,order=c(0,0,11))
rmsear<-accuracy(fit)

fore <- forecast(fit,h=11)

rmsear

```


```{r warning=FALSE,echo=FALSE,fig.width=10,fig.height=7}
pred <- predict(var1,ahead=10)

fore <- pred$fcst
mse <- mean(residuals(var1)[,1]^2)

rmvar <- sqrt(mse)
rmvar

#ggplot()+geom_line(aes(x=as.Date(Date),y=difbtc,color="Data"),data = datadif)+
 # scale_x_date(date_labels = "%m-%Y",breaks = scales::pretty_breaks(n = 15))+geom_line(aes(x=as.Date(data[221:230,]$Date),y=fore$difbtc[,1],color='Forecast'),size=0.8,alpha=0.94)+labs(title="VAR forecasts for Bitcoin Period 1",x="Date",subtitle = "RMSE=0.0500",color="Legend",y="Percentage Change")+geom_ribbon(aes(x=as.Date(data[221:230,]$Date),ymax=fore$difbtc[,3],ymin=fore$difbtc[,2]),fill='cyan',alpha=0.3)+scale_color_manual(values=colors)

```

```{r}
mse <- mean(vecm$residuals[,4]^2)

rmvecm <- sqrt(mse)

rmvecm





```





