---
title: "VARS"
author: "Henrique Magalhaes Rio"
date: "3/28/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tseries)
library(ggpubr)
library(forecast)
library(lubridate)
library(lmtest)
library(vars)
set.seed(2022)
data <- read.csv("CLOSINGPRICEDATA.csv")

```




```{r,echo=FALSE}


#data$Date <-mdy(data$Date)


datadif <-data  %>% mutate(difbtc = data$BTC - lag(data$BTC))

datadif <-datadif %>% mutate(difada = data$ADA - lag(data$ADA))

datadif <-datadif  %>% mutate(difwave = data$WAVES - lag(data$WAVES))

datadif <-datadif  %>% mutate(difeth = data$ETH - lag(data$ETH))

datadif$Date <- as.Date(data$Date)
data1 <- datadif[2:100,8:11]
```


# Bitcoin

```{r}
var1 <- VAR(data1,p=10,type = 'const')
summary(var1)
```
# BTC

```{r warning=FALSE}
pred <- predict(var1,ahead=10)

fore <- pred$fcst

ggplot()+geom_line(aes(x=as.Date(Date),y=difbtc),data = datadif[2:110,])+
  scale_x_date(date_labels = "%m-%Y",breaks = scales::pretty_breaks(n = 15))+geom_line(aes(x=as.Date(data[101:110,]$Date),y=fore$difbtc[,1]),color='red')+labs(title="VAR forecasts for Bitcoin",x="Date")
```

```{r}
ggAcf(resid(var1))
fanchart(pred)

```



# ADA

```{r warning=FALSE}
pred <- predict(var1,ahead=10)

fore <- pred$fcst

ggplot()+geom_line(aes(x=as.Date(Date),y=difada),data = datadif[2:110,])+
  scale_x_date(date_labels = "%m-%Y",breaks = scales::pretty_breaks(n = 15))+geom_line(aes(x=as.Date(data[101:110,]$Date),y=fore$difada[,1]),color='red')+labs(title="VAR forecasts for ADA",x="Date")
```

```{r}
res<-resid(var1)
ggAcf(res[,2])
fanchart(pred)

```










# WAVE


```{r warning=FALSE}
pred <- predict(var1,ahead=10)

fore <- pred$fcst

ggplot()+geom_line(aes(x=as.Date(Date),y=difwave),data = datadif[2:110,])+
  scale_x_date(date_labels = "%m-%Y",breaks = scales::pretty_breaks(n = 15))+geom_line(aes(x=as.Date(data[101:110,]$Date),y=fore$difwave[,1]),color='red')+labs(title="VAR forecasts for ADA",x="Date")
```

```{r}
res<-resid(var1)
ggAcf(res[,3])
fanchart(pred)

```


```{r}
res <- resid(var1)


```




#ETH

```{r warning=FALSE}
pred <- predict(var1,ahead=10)

fore <- pred$fcst

ggplot()+geom_line(aes(x=as.Date(Date),y=difeth),data = datadif[2:110,])+
  scale_x_date(date_labels = "%m-%Y",breaks = scales::pretty_breaks(n = 15))+geom_line(aes(x=as.Date(data[101:110,]$Date),y=fore$difeth[,1]),color='red')+labs(title="VAR forecasts for ADA",x="Date")
```

```{r}
res<-resid(var1)
ggAcf(res[,4])
fanchart(pred)

```


```{r}
res <- resid(var1)


```





